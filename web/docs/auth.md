# Auth

This page explains the authentication and authoritaion for files-crud.

## Authontication type
files-crud authenticates users, using username-password-authentication.

## Hashing
Currently, passwords are hashed, using [scrypt](https://en.wikipedia.org/wiki/Scrypt), with following parameters:
* iterations count: 131072
* block size: 8
* parallelism: 1
* max memory: 176160768
* hash length: 32 bytes
* salt: 16 randomly generated bytes, generated at registration
* password: the provided password

## Token
On successful authentication, a JWT token will be issued. \
The token will be signed, using HMAC-256, with a key, randomly chosen from 20 keys, randomly created at first application startup.

On subsequent requests this token has to be provided as the value of the `Authorization` request header (`Bearer` prefix is optional).

### JWT Payload properties (aka `claims`)
* sub &minus; ID of the user the JWT belongs to
* iat &minus; Unix timestamp when the JWT was issued (seconds)
* exp &minus; Unix timestamp when the JWT will expire (seconds), 0 if the token never expires

### Response body properties on successful login
* token &minus; The JWT
* expiresAt &minus;
  Unix timestamp when the JWT will expire (milli seconds), 0 if the token never expires

### See also
[API: User Endpoints - Login](/api/user#login)


## Login attempts limitation and locks
After 5 consecutive invalid login attempts with the same username,
subsequent attempts with this username are locked for 15 seconds. \
It does not matter, if a user with this username exists. \
After 6 invalid attempts the lock will last for 30 seconds, after 7 attempts for 1 minute, and so on.
This doubles each subsequent attempt, with a cap on 15 Minutes.

If a login is attempted during a lock, the lock time restarts and the attempt counter is untouched.

Only when a successful attempt with the username occurs, the invalid attempt counter will be reset to 0.

Respective duration of the blocking depending on the number of failed attempts:
* upto 4: None
* 5: 15 seconds
* 6: 30 seconds
* 7: 1 minute
* 8: 2 minutes
* 9: 4 minutes
* 10: 8 minutes
* from 11: 15 minutes

So 100 invalid attempts with same username will take almost 23 hours (22.7625).
